type vendor_hal_hwcextension_xiaomi_service, hal_service_type, protected_service, service_manager_type;
type vendor_miclstc_service, vndservice_manager_type;
type vendor_mistcdisplay_service, vndservice_manager_type;

get_prop(hal_graphics_composer, vendor_displayfeature_prop)
get_prop(hal_graphics_composer_default, vendor_displayfeature_prop)
get_prop(hal_graphics_composer_default, vendor_fp_prop)
set_prop(hal_graphics_composer_default, vendor_displayfeature_prop)

allow hal_graphics_composer_client vendor_hal_hwcextension_xiaomi_service:service_manager find;
allow hal_graphics_composer_default vendor_displayfeature_device:chr_file { ioctl open read };
allow hal_graphics_composer_default vendor_hal_citsensorservice_xiaomi_default:binder { call transfer };
allow hal_graphics_composer_default vendor_hal_citsensorservice_xiaomi_default:fd *;
allow hal_graphics_composer_default vendor_hal_citsensorservice_xiaomi_service:service_manager find;
allow hal_graphics_composer_default vendor_hal_displayfeature_xiaomi_service:service_manager find;
allow hal_graphics_composer_default vendor_miclstc_service:service_manager { add find };
allow hal_graphics_composer_default vendor_mistcdisplay_service:service_manager { add find };
allow hal_graphics_composer_default vendor_sysfs_displayfeature:dir { open read search };
allow hal_graphics_composer_default vendor_sysfs_displayfeature:file { open read write };
allow hal_graphics_composer_server vendor_hal_hwcextension_xiaomi_service:service_manager { add find };
